(()=>{"use strict";var e={n:r=>{var t=r&&r.__esModule?()=>r.default:()=>r;return e.d(t,{a:t}),t},d:(r,t)=>{for(var o in t)e.o(t,o)&&!e.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:t[o]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r)};const r=require("router");var t=e.n(r);const o=require("RedirectUtil");var n=e.n(o);const a=require("storage");var d=e.n(a);const s=require("ResourceLocatorUtil");var c=e.n(s),i=function(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var o,n,a=t.call(e),d=[];try{for(;(void 0===r||r-- >0)&&!(o=a.next()).done;)d.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(n)throw n.error}}return d},l=function(e,r,t){if(t||2===arguments.length)for(var o,n=0,a=r.length;n<a;n++)!o&&n in r||(o||(o=Array.prototype.slice.call(r,0,n)),o[n]=r[n]);return e.concat(o||Array.prototype.slice.call(r))},u=d().getKeyValueDataStore("paretosec-dev");t().get("/all",(function(e,r){var t={},o={nodes:[]};try{o=u.get("redirectNodes")}catch(e){r.json({redirects:"No redirects found"})}o.nodes.length?(o.nodes.map((function(e){t[e]=n().getRedirectURIs(c().getNodeByUrl(e))})),r.json({redirects:t})):r.json({redirects:"No redirects found"})})),t().get("/add-redirects",(function(e,r){var t=e.params,o=[],a=[];if(!Object.keys(t).length)return r.json({message:"Please add proper data"});Object.keys(t).map((function(e){var r=c().getNodeByUrl(e),d=t[e];r?(-1===o.indexOf(e)&&o.push(e),"string"==typeof d?n().addRedirectURI(r,d):n().addRedirectURIs(r,d)):a.push("No existing page found for ".concat(e))}));var d={nodes:[]};try{d=u.get("redirectNodes")}catch(e){u.put("redirectNodes",{nodes:[]})}var s={};s=d.nodes.length?{nodes:l([],i(new Set(l(l([],i(o),!1),i(d.nodes),!1))),!1)}:{nodes:o},u.put("redirectNodes",s),r.json({message:"Success",errors:a,newNodes:o,mergedNodes:s})})),t().get("/delete-one-redirect",(function(e,r){var t=c().getNodeByUrl(e.params.url),o=e.params.path;n().removeRedirectURI(t,o),r.json({message:"".concat(o," was deleted from ").concat(t)})})),t().get("/delete-all-redirects-for-one-page-url",(function(e,r){var t=e.params.url,o=c().getNodeByUrl(t);n().removeAllRedirectURIs(o);var a=u.get("redirectNodes").nodes;delete a[a.indexOf(t)],u.put("redirectNodes",{nodes:a}),r.json({message:"All redirects was deleted for: '".concat(o,"' ")})}))})();